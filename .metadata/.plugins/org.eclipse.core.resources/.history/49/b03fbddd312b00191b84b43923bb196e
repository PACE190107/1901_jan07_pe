package com.revature.data;

import java.sql.CallableStatement;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.List;

import org.apache.log4j.Logger;
import com.revature.models.Employee;
import com.revature.models.Request;
import com.revature.util.ERSConnectionUtil;

import oracle.jdbc.OracleCallableStatement;
import oracle.jdbc.OracleTypes;

public class DataSource {
	
	final static Logger log = Logger.getLogger(DataSource.class);
	private static final DataSource instance = new DataSource();
	private final List<Employee> employees = new ArrayList<>();
	private final List<Request> requests = new ArrayList<>();
	
	private DataSource() {
		employees.add(new Employee(1,"Joshua","Bjork","339 34th Avenue East Moline, IL 61244","joshuabjork@gmail.com","jbjork","jbjork",0));
		employees.add(new Employee(2,"Randy","Poffo","4734 96th Street Seminole, FL 33708","madness@gmail.com","savage","savage",0));
		employees.add(new Employee(3,"Richard","Fliehr","1896 3rd Avenue Charlotte, NC 28105","naitch@gmail.com","naitch","naitch",0));
		employees.add(new Employee(4,"Michael","Hickenbottom","6783 75th Avenue San Antonio, TX 78201","hbk@gmail.com","hbk","hbk",0));
		employees.add(new Employee(5,"Paul","Levesque","645 71st Avenue Stamford, CT  06956","trips@gmail.com","admin","admin",1));
		requests.add(new Request(1, 1, 1, 2, "Enterprise", "Travel expenses", 250, 1));
		requests.add(new Request(1, 1, 2, 2, "Oracle", "OCP Exam", 250, 1));
		requests.add(new Request(0, 1, 3, 2, "Starbucks", "Lunch", 10.65, 0));
		requests.add(new Request(1, 1, 4, 3, "Uhaul", "Travel expenses", 250, 1));
		requests.add(new Request(1, 1, 5, 3, "Oracle", "OCP Exam", 250, 1));
		requests.add(new Request(1, 5, 6, 3, "Panera", "Client Lunch", 145.28, 1));
		requests.add(new Request(1, 1, 7, 4, "Uhaul", "Travel expenses", 250, 1));
		requests.add(new Request(0, 5, 8, 4, "Subway", "Lunch", 7.24, 0));
		requests.add(new Request(0, 1, 9, 4, "Five Guys", "Lunch", 13.29, 0));
//			String sql = "call GET_ALL_EMP_INFO(?)";
//			CallableStatement cs = conn.prepareCall(sql);
//			cs.registerOutParameter(1, OracleTypes.CURSOR);
//			cs.execute();
//			ResultSet rs = ((OracleCallableStatement)cs).getCursor(1);
//			while (rs.next()) {
//				employees.add(new Employee(
//						rs.getInt("EMP_ID"),
//						rs.getString("EMP_FNAME"),
//						rs.getString("EMP_LNAME"),
//						rs.getString("EMP_ADDR"),
//						rs.getString("EMP_EMAIL"),
//						rs.getString("EMP_UNAME"),
//						rs.getString("EMP_PASS"),
//						rs.getInt("EMP_ISMGR")));
//			}
//			String sql = "select * ers_emp";
//			Statement stmt = conn.createStatement();
//			ResultSet rs = stmt.executeQuery(sql);
//			while (rs.next()) {
//				employees.add(new Employee(
//					rs.getInt("EMP_ID"),
//					rs.getString("EMP_FNAME"),
//					rs.getString("EMP_LNAME"),
//					rs.getString("EMP_ADDR"),
//					rs.getString("EMP_EMAIL"),
//					rs.getString("EMP_UNAME"),
//					rs.getString("EMP_PASS"),
//					rs.getInt("EMP_ISMGR")));
//			}
//			employees.get(0).setId(0);
//			employees.get(0).setFirstname("Josh");
//			employees.get(0).setLastname("Bjork");
//			employees.get(0).setAddress("339 34th Avenue East Moline, IL 61244");
//			employees.get(0).setEmail("joshuabjork@gmail.com");
//			employees.get(0).setUsername("jbjork");
//			employees.get(0).setPassword("jbjork");
//			employees.get(0).setIsManager(0);
//			sql = "call GET_ALL_REQ(?)";
//			cs = conn.prepareCall(sql);
//			cs.registerOutParameter(1, OracleTypes.CURSOR);
//			cs.execute();
//			rs = ((OracleCallableStatement)cs).getCursor(1);
//			while (rs.next()) {
//				requests.add(new Request(
//						rs.getInt("REQ_ID"),
//						rs.getInt("EMP_SUBMIT"),
//						rs.getString("REQ_VENDOR"),
//						rs.getString("REQ_DESC"),
//						rs.getDouble("REQ_AMOUNT"),
//						rs.getInt("REQ_PENDING"),
//						rs.getInt("MGR_APPROVE"),
//						rs.getInt("REQ_APPROVED")));
//			}
//			sql = "select * from ers_req";
//			stmt = conn.createStatement();
//			rs = stmt.executeQuery(sql);
//			while (rs.next()) {
//				requests.add(new Request(
//						rs.getInt("REQ_PENDING"),
//						rs.getInt("MGR_APPROVE"),
//						rs.getInt("REQ_ID"),
//						rs.getInt("EMP_SUBMIT"),
//						rs.getString("REQ_VENDOR"),
//						rs.getString("REQ_DESC"),
//						rs.getDouble("REQ_AMOUNT"),
//						rs.getInt("REQ_APPROVED")
//						));
//			}
	}
	
	public static DataSource getInstance() {
		return instance;
	}
	
	public List<Employee> getEmployeeTable() {
		return employees;
	}
	
	public List<Request> getRequestTable() {
		return requests;
	}
}
